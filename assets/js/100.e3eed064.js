(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{179:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("ul",[t._m(3),t._v(" "),a("li",[t._v("Updating "),a("router-link",{attrs:{to:"/guides/routing/redux-state.html#routernext"}},[a("code",[t._v("router.next")])]),t._v(" after the route matches but before the view mounts")],1),t._v(" "),t._m(4)]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._m(9),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),a("p",[t._v("Now let’s actually handle updating the vertical:")]),t._v(" "),t._m(13),t._m(14),t._v(" "),t._m(15),t._v(" "),a("p",[t._v("Next we have a requirement to attach product-specific data to the "),a("code",[t._v("page-view")]),t._v(" logging event that fires when the user views the PDP. We do this by passing "),a("code",[t._v("logParams")]),t._v(" to "),a("router-link",{attrs:{to:"/components/PageViewDispatcher.html"}},[a("code",[t._v("<PageViewDispatcher>")])]),t._v(":")],1),t._v(" "),t._m(16),t._m(17),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._m(21)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("a",{attrs:{href:"/guides/routing"}},[this._v("← Routing docs")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"writing-a-route-hook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#writing-a-route-hook","aria-hidden":"true"}},[this._v("#")]),this._v(" Writing a Route Hook")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("In this document we’ll be building the "),s("a",{attrs:{href:"/src/components/RouteHooks/ProductViewLoader.js"}},[s("code",[this._v("<ProductViewLoader>")])]),this._v(" route hook from scratch to demonstrate the following concepts:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("Loading the primary view-specific data before the view mounts (and showing "),s("a",{attrs:{href:"/src/components/PageNotFound/index.js"}},[s("code",[this._v("<PageNotFound>")])]),this._v(" if it fails)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[this._v("Adding view-specific params to the "),s("code",[this._v("page-view")]),this._v(" logging event")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("We’ll use the desire to simplify "),s("a",{attrs:{href:"/src/views/catalog/ProductView/index.js"}},[s("code",[this._v("<ProductView>")])]),this._v(" specifically as the motivation for building "),s("code",[this._v("<ProductViewLoader>")]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"loading-view-specific-data"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#loading-view-specific-data","aria-hidden":"true"}},[this._v("#")]),this._v(" Loading view-specific data")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("One way "),s("code",[this._v("<ProductView>")]),this._v(" can be simplified is to remove the logic for changing the UI vertical based on the product data. This means the product data needs to be downloaded before the View mounts. Here’s a first pass where all "),s("code",[this._v("<ProductViewLoader>")]),this._v(" does is load the product and pass it to "),s("code",[this._v("<ProductView>")]),this._v(":")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ViewRoute")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("path")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URLS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("product")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("':id'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("pageType")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("pdp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n  ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ProductViewLoader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n    ")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" product "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("PageViewDispatcher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ProductView")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("product")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n      ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("PageViewDispatcher")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n    }\n  ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ProductViewLoader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ViewRoute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" loadProduct "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data/catalog'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("ProductViewLoader")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" status "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STATUS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("READY")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("children")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" product "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nProductViewLoader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("propTypes "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PromiseLoader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PropTypes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("input"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PromiseLoader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PropTypes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("output"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" CustomPropTypes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nProductViewLoader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("mapStateToProps")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" router "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Number")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("`match.params.id`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nProductViewLoader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("loadPromisedProps")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadProduct")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" product "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PromiseLoader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("compose")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductViewLoader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Notice that we don’t render "),s("code",[this._v("children")]),this._v(" until we have a "),s("code",[this._v("product")]),this._v(" object. This keeps "),s("code",[this._v("<ProductView>")]),this._v(" simple, as it doesn’t have to check the prop — it will always be a real product.")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("Also take a look at the "),a("code",[t._v("id")]),t._v(" prop in "),a("code",[t._v("mapStateToProps")]),t._v(". Since "),a("code",[t._v("<ProductViewLoader>")]),t._v(" is a route hook, it’s mounted after "),a("code",[t._v("VIEW_ROUTE_MATCH")]),t._v(" dispatches but before "),a("code",[t._v("PAGE_VIEW")]),t._v(", so it needs to initially get the "),a("code",[t._v("id")]),t._v(" from "),a("code",[t._v("router.next")]),t._v(". Then, after "),a("code",[t._v("PAGE_VIEW")]),t._v(" dispatches it re-renders, so it needs to get the "),a("code",[t._v("id")]),t._v(" from "),a("code",[t._v("router")]),t._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"updating-router-next"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#updating-router-next","aria-hidden":"true"}},[this._v("#")]),this._v(" Updating "),s("code",[this._v("router.next")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+   import { loadProduct } from 'data/catalog'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+ import { viewRouteUpdate } from 'actions/router'")]),t._v("\n\n  const ProductViewLoader = ({ product, children, status }) => {\n    return status === STATUS.READY\n      ? children({ product })\n      : <div />\n  }\n\n  ProductViewLoader.propTypes = {\n    id: PromiseLoader.PropTypes.input.number,\n    product: PromiseLoader.PropTypes.output.product,\n    status: CustomPropTypes.status,\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+   uiVertical: CustomPropTypes.vertical,")]),t._v("\n  }\n\n"),a("span",{pre:!0,attrs:{class:"token deleted"}},[t._v("- ProductViewLoader.mapStateToProps = ({ router }) => ({")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+ ProductViewLoader.mapStateToProps = ({ router, ui }) => ({")]),t._v("\n    id: Number(_.get(router.next || router, `match.params.id`)),\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+   uiVertical: ui.vertical,")]),t._v("\n  })\n\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+ ProductViewLoader.mapDispatchToProps = {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+   viewRouteUpdate,")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+ }")]),t._v("\n\n  ProductViewLoader.loadPromisedProps = (props) =>\n    loadProduct(props.id).then((product) => {\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+     const vertical = product.isUnisex ? props.uiVertical : product.vertical")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+     props.uiVertical !== vertical && props.viewRouteUpdate({ vertical })")]),t._v("\n      return { product }\n    })\n\n  export default connect(PromiseLoader.compose(ProductViewLoader))\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("Here we introduce the "),a("code",[t._v("viewRouteUpdate")]),t._v(" action which dispatches "),a("code",[t._v("VIEW_ROUTE_UPDATE")]),t._v(". As you might imagine, it takes a partial "),a("code",[t._v("view")]),t._v(" object and merges it into the current "),a("code",[t._v("router.next.view")]),t._v(" state. This is how navigation event data can be updated asynchronously.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"adding-page-view-logging-params"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adding-page-view-logging-params","aria-hidden":"true"}},[this._v("#")]),this._v(" Adding "),s("code",[this._v("page-view")]),this._v(" logging params")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[t._v("  <ViewRoute path={URLS.product(':id')} pageType='pdp'>\n    <ProductViewLoader>\n"),a("span",{pre:!0,attrs:{class:"token deleted"}},[t._v("-     {({ product }) =>")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+     {({ product, logParams }) =>")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token deleted"}},[t._v("-       <PageViewDispatcher>")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+       <PageViewDispatcher logParams={logParams}>")]),t._v("\n          <ProductView product={product}>\n        </PageViewDispatcher>\n      }\n    </ProductViewLoader>\n  </ViewRoute>\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[t._v("  ...\n\n  const ProductViewLoader = ({ product, children, status }) => {\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+   const logParams = product")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+     ? {")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+       productId: String(product.id),")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+       brandId: String(product.brandId),")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+       brandName: product.brandName,")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+       title: product.title,")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+     }")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+     : undefined")]),t._v("\n    return status === STATUS.READY\n"),a("span",{pre:!0,attrs:{class:"token deleted"}},[t._v("-     ? children({ product })")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+     ? children({ product, logParams })")]),t._v("\n      : <div />\n  }\n\n  ...\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"rendering-pagenotfound-for-bad-data"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rendering-pagenotfound-for-bad-data","aria-hidden":"true"}},[this._v("#")]),this._v(" Rendering "),s("code",[this._v("<PageNotFound>")]),this._v(" for bad data")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("It is possible for users to type a bogus pid in the URL, which would cause the "),s("code",[this._v("loadProduct")]),this._v(" call to throw an error. If this happens we want to show "),s("code",[this._v("<PageNotFound>")]),this._v(":")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[t._v("  <ViewRoute path={URLS.product(':id')} pageType='pdp'>\n    <ProductViewLoader>\n      {({ product, logParams }) =>\n        <PageViewDispatcher logParams={logParams}>\n"),a("span",{pre:!0,attrs:{class:"token deleted"}},[t._v("-         <ProductView product={product}>")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+         {product")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+           ? <ProductView product={product} />")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+           : <PageNotFound />")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+         }")]),t._v("\n        </PageViewDispatcher>\n      }\n    </ProductViewLoader>\n  </ViewRoute>\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[t._v("  ...\n\n  ProductViewLoader.loadPromisedProps = (props) =>\n    loadProduct(props.id, props.fallbackTov1).then((product) => {\n      const vertical = product.isUnisex ? props.uiVertical : product.vertical\n      props.uiVertical !== vertical && props.viewRouteUpdate({ vertical })\n      return { product }\n"),a("span",{pre:!0,attrs:{class:"token deleted"}},[t._v("-   })")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+   }).catch(() =>")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+     ({})")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token inserted"}},[t._v("+   )")]),t._v("\n\n  ...\n")])])])}],!1,null,null,null);n.options.__file="writing-routehook.md";s.default=n.exports}}]);